<!DOCTYPE html>
<html lang="es">
    <head>
        <meta charset="UTF-8">
        <title>Entregas Digitalizadas</title>
        <style>
        body { font-family: 'Arial', sans-serif; margin: 0; }
        .container { width: 98%; margin: 0 auto; }
        .main-title {
            font-size: 18px;
            font-weight: bold;
            color: #004D76;
            text-align: center;
            margin-top: 25px;
            margin-bottom: 5px;
        }
        .subtitle {
            font-size: 14px;
            font-weight: bold;
            text-align: center;
            margin-bottom: 2px;
        }
        .date-print {
            font-size: 13px;
            text-align: center;
            margin-bottom: 15px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 10px;
        }
        th {
            background: #BA005C;
            color: #fff;
            font-weight: bold;
            text-align: center;
            padding: 6px 2px;
            border: 1.5px solid #000;
        }
        td {
            border: 1.5px solid #000;
            padding: 5px 2px;
            text-align: center;
            font-size: 8px;
        }
        .total-row td {
            font-weight: bold;
            background: #EAD3E5;
            font-size: 13px;
            border: 1.5px solid #000;
            padding: 8px 5px;
        }
        .total-label {
            text-align: right !important;
        }
        .total-amount {
            text-align: right !important;
            font-size: 15px;
        }
        td.align-left { text-align: left; }
        td.align-right { 
          text-align: right; 
           
        }
        th:nth-child(8), td:nth-child(8) {
            width: 70px; /* O el ancho que prefieras */
        }
    </style>
    </head>
    <body>
        <div class="container">
            <div class="main-title">REPORTE DE ENTREGAS DIGITALIZADAS</div>
            <div class="subtitle">Período: <%= fechaInicio %> - <%= fechaFin
                %></div>
            <div class="date-print">Fecha de impresión: <%= fechaActual %></div>
            <table>
                <thead>
                    <tr>
                        <th>Nro.</th>
                        <th>Sucursal</th>
                        <th>Zona</th>
                        <th>Fecha Documento</th>
                        <th>Número Doc.</th>
                        <th>Código Cliente</th>
                        <th>Nombre Cliente</th>
                        <th>Metodo de Pago</th>
                        <th>Total</th>
                        <th>UserCode</th>
                        <th>Despachador</th>
                        <th>Fecha Digitalización</th>
                    </tr>
                </thead>
                <tbody>
                    <% if (data.length > 0) { %>
                    <% data.forEach((item, idx) => { %>
                    <tr>
                        <td><%= idx + 1 %></td>
                        <td><%= item.SucName || '' %></td>
                        <td><%= item.ZoneName || '' %></td>
                        <td><%= item.DocDate ? new
                            Date(item.DocDate).toLocaleDateString('es-ES') : ''
                            %></td>
                        <td><%= item.DocNum || '' %></td>
                        <td><%= item.CardCode || '' %></td>
                        <td class="align-left"><%= item.CardName || '' %></td>
                        <td><%= item.PymntGroup || '' %></td>
                        <td class="align-right">Bs <%= parseFloat(item.DocTotal
                            || 0).toFixed(2) %></td>
                        <td><%= item.UserCode || '' %></td>
                        <td><%= item.DeliveryName || '' %></td>
                        <td><%= item.CreateDate ? new
                            Date(item.CreateDate).toLocaleDateString('es-ES') :
                            '' %></td>
                    </tr>
                    <% }) %>
                    <% } else { %>
                    <% for(let i = 0; i < 20; i++) { %>
                    <tr>
                        <td><%= i + 1 %></td>
                        <td></td><td></td><td></td><td></td><td></td>
                        <td class="align-right">Bs 0.00</td>
                        <td></td><td></td>
                    </tr>
                    <% } %>
                    <% } %>
                </tbody>
                <tr class="total-row">
                    <td colspan="6"></td>
                    <td class="total-label">TOTAL GENERAL:</td>
                    <td class="total-amount" colspan="2">Bs <%=
                        parseFloat(totalGeneral).toFixed(2) %></td>
                </tr>
            </table>
        </div>
    </body>
</html>